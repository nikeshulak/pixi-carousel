function Circle(t){t=t||{},this.radius=t.radius||5,this.position=t.position||{x:0,y:0},this.color=t.color||0,this.color_active=t.color_active||0,this.fillAlpha=t.fillAlpha||.9,this.fillAlpha_active=t.fillAlpha_active||.5}function Director(t,i,s){this.now,this.dt,this.then=Date.now(),s=s||{},this.WIDTH=t||640,this.HEIGHT=i||480}function Slide(t,i,s,e){this.width=t||640,this.height=i||480,this.width_cached=this.width,this.height_cached=this.height,this.height=i,this.img_src=s,this.img=e||null,this.anchor={x:.5,y:.5},this.position={x:0,y:0},this.cached_position={x:0,y:0},this.temp_position={x:0,y:0}}function SlideManagerBase(t,i,s){Director.call(this,t,i,s),s=s||{},this.SLIDE_DURATION=s.slide_duration||300,this.SLIDE_PERCENT_Y=s.slide_percent_y||.5,this.CIRCLE_COLOR=s.circle_color||0,this.CIRCLE_COLOR_ACTIVE=s.circle_color_active||0,this.CIRCLE_FILLALPHA=s.circle_fillAlpha||.9,this.CIRCLE_FILLALPHA_ACTIVE=s.circle_fillAlpha_active||.5,this.CIRCLE_RADIUS=s.circle_radius||8,this.CIRCLE_MARGIN=s.circle_margin||25,this.CIRCLE_PERCENT_Y=s.circle_percent_y||.9,this.BKG_COLOR=s.bkg_color||0,this.SCALES={CROP:{},STRETCH:{},FIT:{}},this.scale=null,this.has_circles=s.has_circles||!1,this.speed=this.WIDTH/this.SLIDE_DURATION,this.is_accelerated=s.is_accelerated||!1,this.initial_speed=this.is_accelerated?2*this.WIDTH/this.SLIDE_DURATION:this.speed,this.acceleration=this.is_accelerated?this.initial_speed/this.SLIDE_DURATION:0,this.is_auto_slide=s.is_auto_slide||!1,this.interval=s.interval||1e3,this.zoom_ratio=s.zoom_ratio||2,this.zoom_interval=s.zoom_interval||300,this.states={still:{duration:null},sliding_left:{duration:this.SLIDE_DURATION},sliding_right:{duration:this.SLIDE_DURATION},zoomming_in:{},zoomming_out:{},inspecting:{}},this.state=this.states.still,this.state_time=0,this.slides=[],this.slide_count=0,this.circles=[],this.is_position_adjusted=!1,this.onInit=s.onInit||null,this.onSlideBegin=s.onSlideBegin||null,this.onSlideEnd=s.onSlideEnd||null}function SlideManager(t,i,s){SlideManagerBase.call(this,t,i,s),this.textures=[],this.sprites=[],this.graphics=new PIXI.Graphics,this.stage=new PIXI.Container,this.renderer=new PIXI.CanvasRenderer(t,i,{view:s.view,backgroundColor:this.BKG_COLOR},!0)}Director.prototype.animate=function(){this.now=Date.now(),this.dt=this.now-this.then,requestAnimationFrame(this.animate.bind(this)),this.updateAndRender(this.dt),this.then=this.now},Director.prototype.updateAndRender=function(t){this.update(t),this.render()},Director.prototype.update=function(t){},Director.prototype.render=function(){},Slide.prototype.cache_position=function(){this.cached_position.x=this.position.x,this.cached_position.y=this.position.y},Slide.prototype.restoreCachedPosition=function(){this.position.x=this.cached_position.x,this.position.y=this.cached_position.y},Slide.prototype.saveTempPosition=function(){this.temp_position.x=this.position.x,this.temp_position.y=this.position.y},Slide.prototype.cache_size=function(){this.width_cached=this.width,this.height_cached=this.height},SlideManagerBase.prototype=Object.create(Director.prototype),SlideManagerBase.prototype.getZoomedLength=function(t,i){return.37*t*Math.log(i+(1+Math.sqrt(1+4*this.zoom_interval))/2)},SlideManagerBase.prototype.zoomIn=function(){if(this.state===this.states.still){this.state=this.states.zoomming_in,this.state_time=0;var t=this.getActiveSlide();t&&(t.cache_position(),t.saveTempPosition(),t.cache_size())}},SlideManagerBase.prototype.zoomOut=function(){if(this.state===this.states.inspecting){var t=this.getActiveSlide();t&&t.restoreCachedPosition(),this.state=this.states.zoomming_out,this.state_time=0}},SlideManagerBase.prototype.update=function(t){if(Director.prototype.update.call(this,t),!(this.slide_count<2))switch(this.state_time+=t,this.state){case this.states.still:this.is_auto_slide===!0&&this.state_time>this.interval&&this.slideLeft();break;case this.states.zoomming_in:if(this.state_time>this.zoom_interval)this.state=this.states.inspecting,this.state_time=0;else{var i=this.getActiveSlide();i.width=this.getZoomedLength(i.width_cached,this.state_time),i.height=this.getZoomedLength(i.height_cached,this.state_time)}break;case this.states.zoomming_out:var i=this.getActiveSlide();this.state_time>this.zoom_interval?(this.state=this.states.still,this.state_time=0,i.width=i.width_cached,i.height=i.height_cached):(i.width=3*i.width_cached-this.getZoomedLength(i.width_cached,this.state_time),i.height=3*i.height_cached-this.getZoomedLength(i.height_cached,this.state_time));break;case this.states.inspecting:default:if(this.state_time>this.state.duration){this.onSlideEnd&&this.onSlideEnd();for(var s=this.getActiveSlide(),e=this.WIDTH/2-s.position.x,h=0;h<this.slide_count;h++)this.slides[h].position.x+=e;this.state=this.states.still,this.state_time=this.state_time-this.state.duration,this.adjustCircles()}else{switch(this.state){case this.states.sliding_left:this.updateSliding();break;case this.states.sliding_right:this.updateSliding()}this.adjustPosition()}}},SlideManagerBase.prototype.updateSliding=function(){for(var t=this.state===this.states.sliding_left?-1:1,i=0;i<this.slide_count;i++){var s=this.initial_speed*this.state_time-.5*this.acceleration*Math.pow(this.state_time,2);this.slides[i].position.x=this.slides[i].cached_position.x+t*s}},SlideManagerBase.prototype.getSpeed=function(){return this.state===this.states.still?0:this.is_accelerated?this.initial_speed-this.acceleration*this.state_time:this.initial_speed},SlideManagerBase.prototype.getActiveSlide=function(){if(!this.slides.length)return!1;var t=this.slides.reduce(function(t,i){return Math.abs(t.position.x-this.WIDTH/2)<Math.abs(i.position.x-this.WIDTH/2)?t:i}.bind(this));return t},SlideManagerBase.prototype.getActiveIndex=function(){return this.slides.length?this.slides.indexOf(this.getActiveSlide()):!1},SlideManagerBase.prototype.adjustCircles=function(){for(var t=this.slides.indexOf(this.getActiveSlide()),i=0,s=this.circles.length;s>i;i++)this.circles[i].color=this.CIRCLE_COLOR,this.circles[i].fillAlpha=this.CIRCLE_FILLALPHA;this.circles[t].color=this.CIRCLE_COLOR_ACTIVE,this.circles[t].fillAlpha=this.CIRCLE_FILLALPHA_ACTIVE},SlideManagerBase.prototype.adjustPosition=function(){if(!this.is_position_adjusted){var t=this.slides.reduce(function(t,i){return t.position.x<i.position.x?t:i}.bind(this)),i=this.slides.reduce(function(t,i){return t.position.x>i.position.x?t:i}.bind(this));this.state===this.states.sliding_left&&t.position.x<this.WIDTH/2&&t!==this.getActiveSlide()?(t.position.x=i.position.x+this.WIDTH,t.cached_position.x=i.cached_position.x+this.WIDTH):this.state===this.states.sliding_right&&i.position.x>this.WIDTH/2&&i!==this.getActiveSlide()&&(i.position.x=t.position.x-this.WIDTH,i.cached_position.x=t.cached_position.x-this.WIDTH),this.is_position_adjusted=!0}},SlideManagerBase.prototype.slideLeft=function(){this.state===this.states.still&&(this.onSlideBegin&&this.onSlideBegin(),this.is_position_adjusted=!1,this.cache_slide_positions(),this.state=this.states.sliding_left,this.state_time=0)},SlideManagerBase.prototype.slideRight=function(){this.state===this.states.still&&(this.onSlideBegin&&this.onSlideBegin(),this.is_position_adjusted=!1,this.cache_slide_positions(),this.state=this.states.sliding_right,this.state_time=0)},SlideManagerBase.prototype.panTo=function(t,i){if(this.state===this.states.inspecting){var s=this.getActiveSlide();s&&(t-.5*s.width>=0||t+.5*s.width<=this.WIDTH||(s.position.x=t),i-.5*s.height>=0||i+.5*s.height<=this.HEIGHT||(s.position.y=i))}},SlideManagerBase.prototype.startAutoSlide=function(t){this.interval=t||this.interval,this.is_auto_slide=!0},SlideManagerBase.prototype.stopAutoSlide=function(){this.is_auto_slide=!1},SlideManagerBase.prototype.cache_slide_positions=function(){for(var t=0;t<this.slide_count;t++)this.slides[t].cache_position()},SlideManagerBase.prototype.setSlidesAndStart=function(t,i){this.setSlides(t,i),this.init(),this.animate()},SlideManagerBase.prototype.setSlides=function(t,i){i=i||{};var s=i.width||this.WIDTH,e=i.height||this.HEIGHT;this.slide_count=t.length;for(var h=0;h<this.slide_count;h++)this.slides.push("string"==typeof t[h]?new Slide(s,e,t[h],null):new Slide(s,e,null,t[h]))},SlideManagerBase.prototype.init=function(){for(var t=this.slide_count,i=this.WIDTH/2-(t-1)*this.CIRCLE_MARGIN/2,s=0;t>s;s++){var e=this.slides[s];switch(e.anchor.x=.5,e.anchor.y=.5,e.position.x=this.WIDTH/2+s*this.WIDTH,e.position.y=this.HEIGHT*this.SLIDE_PERCENT_Y,this.scale){case this.SCALES.STRETCH:e.width=this.WIDTH,e.height=this.HEIGHT,e.position.y=.5*this.HEIGHT;case this.SCALES.FIT:var h=e.width/e.height;h>this.WIDTH/this.HEIGHT?(e.width=this.WIDTH,e.height=e.width/h):(e.height=this.HEIGHT,e.width=e.height*h);case this.SCALES.CROP:}var o=new Circle({radius:this.CIRCLE_RADIUS,position:{x:i+this.CIRCLE_MARGIN*s,y:this.HEIGHT*this.CIRCLE_PERCENT_Y},color:0===s?this.CIRCLE_COLOR_ACTIVE:this.CIRCLE_COLOR,fillAlpha:0===s?this.CIRCLE_FILLALPHA_ACTIVE:this.CIRCLE_FILLALPHA});this.circles.push(o)}this.onInit&&this.onInit()},SlideManager.prototype=Object.create(SlideManagerBase.prototype),SlideManager.prototype.render=function(){this.has_circles&&this.renderCircles();for(var t=0,i=this.slide_count;i>t;t++){var s=this.slides[t],e=this.sprites[t];e.width=s.width,e.height=s.height}this.renderer.render(this.stage)},SlideManager.prototype.renderCircles=function(){this.graphics.clear();var t=this.circles.length;if(t>1)for(var i=0;t>i;i++){var s=this.circles[i];this.graphics.beginFill(s.color),this.graphics.fillAlpha=s.fillAlpha,this.graphics.drawCircle(s.position.x,s.position.y,s.radius),this.graphics.endFill()}},SlideManager.prototype.init=function(){SlideManagerBase.prototype.init.call(this);for(var t=0,i=this.slide_count;i>t;t++){var s=this.slides[t];if(s.img)var e=new PIXI.BaseTexture(s.img),h=new PIXI.Texture(e);else var h=PIXI.Texture.fromImage(s.img_src);this.textures.push(h);var o=new PIXI.Sprite(h);if(o.width=s.width,o.height=s.height,o.anchor=s.anchor,o.position=s.position,this.sprites.push(o),this.stage.addChild(o),this.has_circles){var a=this.circles[t];this.graphics.beginFill(16777215),this.graphics.fillAlpha=a.fillAlpha,this.graphics.drawCircle(a.position.x,a.position.y,a.radius),this.graphics.endFill()}this.stage.addChild(this.graphics)}};
//# sourceMappingURL=pixi-carousel.min.js.map